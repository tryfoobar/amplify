"use strict";(()=>{var k=function(){function t(){}return t.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:L(),platform:"Web",os:void 0,deviceModel:void 0}},t}(),L=function(){return typeof navigator<"u"&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},U=function(){function t(){this.queue=[]}return t.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},t.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(n){e(n)}),this.queue=[])},t}(),p=function(){return p=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c])}return e},p.apply(this,arguments)};function A(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,c=[],g;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)c.push(i.value)}catch(l){g={error:l}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(g)throw g.error}}return c}var _=function(t,e){var n,r,i=["string","number","boolean","undefined"],c=typeof t,g=typeof e;if(c!==g)return!1;try{for(var l=A(i),f=l.next();!f.done;f=l.next()){var s=f.value;if(s===c)return t===e}}catch(h){n={error:h}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;var o=Array.isArray(t),a=Array.isArray(e);if(o!==a)return!1;if(o&&a){for(var u=0;u<t.length;u++)if(!_(t[u],e[u]))return!1}else{var y=Object.keys(t).sort(),v=Object.keys(e).sort();if(!_(y,v))return!1;var d=!0;return Object.keys(t).forEach(function(h){_(t[h],e[h])||(d=!1)}),d}return!0},q="$set",B="$unset",N="$clearAll";Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,r=new Array(n);n--;)r[n]=[e[n],t[e[n]]];return r});var T=function(){function t(){this.identity={userProperties:{}},this.listeners=new Set}return t.prototype.editIdentity=function(){var e=this,n=p({},this.identity.userProperties),r=p(p({},this.identity),{userProperties:n});return{setUserId:function(i){return r.userId=i,this},setDeviceId:function(i){return r.deviceId=i,this},setUserProperties:function(i){return r.userProperties=i,this},setOptOut:function(i){return r.optOut=i,this},updateUserProperties:function(i){var c,g,l,f,s,o,a=r.userProperties||{};try{for(var u=A(Object.entries(i)),y=u.next();!y.done;y=u.next()){var v=b(y.value,2),d=v[0],h=v[1];switch(d){case q:try{for(var S=(l=void 0,A(Object.entries(h))),m=S.next();!m.done;m=S.next()){var C=b(m.value,2),x=C[0],K=C[1];a[x]=K}}catch(w){l={error:w}}finally{try{m&&!m.done&&(f=S.return)&&f.call(S)}finally{if(l)throw l.error}}break;case B:try{for(var E=(s=void 0,A(Object.keys(h))),I=E.next();!I.done;I=E.next()){var x=I.value;delete a[x]}}catch(w){s={error:w}}finally{try{I&&!I.done&&(o=E.return)&&o.call(E)}finally{if(s)throw s.error}}break;case N:a={};break}}}catch(w){c={error:w}}finally{try{y&&!y.done&&(g=u.return)&&g.call(u)}finally{if(c)throw c.error}}return r.userProperties=a,this},commit:function(){return e.setIdentity(r),this}}},t.prototype.getIdentity=function(){return p({},this.identity)},t.prototype.setIdentity=function(e){var n=p({},this.identity);this.identity=p({},e),_(n,this.identity)||this.listeners.forEach(function(r){r(e)})},t.prototype.addIdentityListener=function(e){this.listeners.add(e)},t.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},t}(),P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,D=function(){function t(){this.identityStore=new T,this.eventBridge=new U,this.applicationContextProvider=new k}return t.getInstance=function(e){return P.analyticsConnectorInstances||(P.analyticsConnectorInstances={}),P.analyticsConnectorInstances[e]||(P.analyticsConnectorInstances[e]=new t),P.analyticsConnectorInstances[e]},t}();var $=["boot"];var M="$default_instance";function O(t){var i,c,g,l;let e=window.engagement,n={_q:(i=e==null?void 0:e._q)!=null?i:[],_configuration:{apiKey:(g=(c=e==null?void 0:e._configuration)==null?void 0:c.apiKey)!=null?g:"",serverUrl:(l=e==null?void 0:e._configuration)==null?void 0:l.serverUrl},_sentry:void 0,init(f,s){var o,a,u;n._configuration={apiKey:f,...s,options:{...s==null?void 0:s.options}},(a=(o=n._configuration)==null?void 0:o.options)!=null&&a.logger&&n._configuration.options.logger.enable((u=n._configuration.options.logLevel)!=null?u:0),t()},plugin(f){let s=n.init;return{name:"@amplitude/engagement-browser",type:"enrichment",async setup(o,a){var v;let u=(v=o.instanceName)!=null?v:M,y=D.getInstance(u).identityStore;s(o.apiKey,{options:{logLevel:o.logLevel},...f,serverZone:o.serverZone}),await window.engagement.boot({user:()=>{let d=y.getIdentity();return{user_id:a.getUserId(),device_id:a.getDeviceId(),user_properties:d.userProperties,session_id:a.getSessionId()}},integrations:[{track:d=>{a.track(d)}}]}),y.addIdentityListener(d=>{window.engagement._setUserProperties(d.userProperties)})},async execute(o){return window.engagement.trigger(o),o}}}},r=n;return new Proxy(n,{get:function(f,s){if(s in r)return r[s];if(s!=="then")return s==="gs"?new Proxy({},{get:function(o,a){return function(){let u=Array.from(arguments),y=`${s}.${a}`;u.unshift(y),n._q.push(u)}}}):$.includes(s)?function(){let o=Array.prototype.slice.call(arguments);return new Promise((a,u)=>{o.unshift(s,a,u),n._q.push(o)})}:function(){let o=Array.prototype.slice.call(arguments);o.unshift(s),n._q.push(o)}}})}var R=()=>{function t(e){for(let n of e){let r=document.createElement("script");r.src=n,r.id="engagement-sdk-bundle";let i=document.querySelector("[nonce]");i&&r.setAttribute("nonce",i.nonce||i.getAttribute("nonce")),document.getElementsByTagName("head")[0].appendChild(r)}}return O(()=>t(["https://cdn.amplitude.com/engagement-browser/prod/index.min.js.gz"]))};window.engagement=R();})();

console.log('Engagement SDK loaded');